(function(n,o){typeof exports=="object"&&typeof module<"u"?o(exports):typeof define=="function"&&define.amd?define(["exports"],o):(n=typeof globalThis<"u"?globalThis:n||self,o(n.YouTubeLazyLoad={}))})(this,(function(n){"use strict";class o{static embedCache=new Map;element;videoId;autoplay;loop;muted;isLoaded=!1;isLoading=!1;playColor;static config;constructor(e){if(this.element=e,this.videoId=e.dataset.videoId||"",this.autoplay=e.dataset.autoplay==="true",this.loop=e.dataset.loop==="true",this.muted=e.dataset.muted==="true",this.playColor=e.dataset.playColor,!this.videoId){console.error("YouTube Lazy Load: O atributo data-video-id é obrigatório.",this.element);return}this.init()}static init(e={}){const t={selector:".youtube-lazy-load",thumbnailQuality:"maxresdefault",observerThreshold:.25,observerRootMargin:"50px",defaultParams:new URLSearchParams({rel:"0",showinfo:"0",modestbranding:"1",iv_load_policy:"3"})};this.config={...t,...e},document.querySelectorAll(this.config.selector).forEach(s=>{this.embedCache.has(s)||this.embedCache.set(s,new o(s))}),this.observeDOM()}init(){this.element.classList.add("youtube-embed"),this.createDOMStructure(),this.loadThumbnail(),this.setupEventListeners(),this.setupAutoplay(),this.addIndicators()}createDOMStructure(){const e=document.createElement("div");e.className="youtube-embed__content";const t=document.createElement("div");t.className="youtube-embed__play",this.playColor&&t.style.setProperty("--play-color",this.playColor),e.appendChild(t),this.element.innerHTML="",this.element.appendChild(e)}loadThumbnail(){const e=`https://img.youtube.com/vi/${this.videoId}/${o.config.thumbnailQuality}.jpg`,t=new Image;t.className="youtube-embed__thumbnail",t.alt=`Thumbnail for YouTube video ${this.videoId}`,t.loading="lazy",t.onerror=()=>{o.config.thumbnailQuality==="maxresdefault"&&(t.src=`https://img.youtube.com/vi/${this.videoId}/sddefault.jpg`)},t.src=e;const i=this.element.querySelector(".youtube-embed__content");i?.insertBefore(t,i.firstChild)}setupEventListeners(){this.autoplay||this.element.addEventListener("click",this.loadVideo,{once:!0}),this.element.addEventListener("mouseenter",this.preconnect,{once:!0})}setupAutoplay(){if(this.autoplay)if("IntersectionObserver"in window){const e=new IntersectionObserver(t=>{t.forEach(i=>{i.isIntersecting&&(this.loadVideo(),e.unobserve(this.element))})},{threshold:o.config.observerThreshold,rootMargin:o.config.observerRootMargin});e.observe(this.element)}else setTimeout(()=>this.loadVideo(),300)}preconnect=()=>{["https://www.youtube-nocookie.com","https://www.google.com","https://googleads.g.doubleclick.net","https://static.doubleclick.net"].forEach(t=>{const i=document.createElement("link");i.rel="preconnect",i.href=t,document.head.appendChild(i)})};loadVideo=()=>{if(this.isLoaded||this.isLoading)return;this.isLoading=!0,this.element.classList.add("youtube-embed--loading");const e=this.createIframe(),t=this.element.querySelector(".youtube-embed__content");e.onload=()=>{this.isLoaded=!0,this.isLoading=!1,this.element.classList.remove("youtube-embed--loading"),this.element.classList.add("youtube-embed--loaded");const i=t?.querySelector(".youtube-embed__thumbnail"),s=t?.querySelector(".youtube-embed__play");i?.remove(),s?.remove()},t?.appendChild(e)};createIframe(){const e=document.createElement("iframe"),t=new URLSearchParams(o.config.defaultParams);return t.set("autoplay","1"),t.set("mute",this.muted?"1":"0"),this.loop&&(t.set("loop","1"),t.set("playlist",this.videoId)),e.src=`https://www.youtube-nocookie.com/embed/${this.videoId}?${t.toString()}`,e.title=`YouTube video player - ${this.videoId}`,e.frameBorder="0",e.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",e.allowFullscreen=!0,e.loading="lazy",e}addIndicators(){this.autoplay&&this.element.classList.add("youtube-embed--autoplay"),this.loop&&this.element.classList.add("youtube-embed--loop")}static observeDOM(){if(!("MutationObserver"in window))return;new MutationObserver(t=>{for(const i of t)i.type==="childList"&&i.addedNodes.forEach(s=>{s.nodeType===1&&s.matches(this.config.selector)&&this.init()})}).observe(document.body,{childList:!0,subtree:!0})}}typeof window<"u"&&(window.YouTubeLazyLoad=o,document.addEventListener("DOMContentLoaded",()=>o.init())),n.YouTubeLazyLoad=o,Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})}));
